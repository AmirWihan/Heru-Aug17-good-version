
# Product Requirements Document: VisaFor CRM

---

## 1. Introduction

### 1.1. Purpose
This document outlines the product requirements for **VisaFor**, an AI-powered Customer Relationship Management (CRM) platform designed to streamline the immigration process for legal professionals and their clients. It details user roles, features, and technical specifications for the application.

### 1.2. Scope
The scope of this document covers the core functionality of the VisaFor platform, including three primary user roles (Super Admin, Lawyer, Client), their respective dashboards, AI-powered tools, client management, and communication features.

## 2. User Roles & Personas

The platform is designed for three distinct user roles:

*   **Client / Applicant:** Individuals seeking immigration services. They need to track their case, communicate with their lawyer, and manage their documents.
*   **Lawyer / Legal Professional:** Licensed immigration lawyers or consultants managing multiple clients, cases, and their own team members within the CRM.
*   **Super Admin:** The platform administrator responsible for overall user management, system health, financial oversight, and platform-wide settings.

## 3. Platform-Wide Features

### 3.1. Authentication
*   **Registration:** Users can sign up as either a "Lawyer/Professional" or "Client/Applicant". Registration requires a full name, email, and password.
*   **Login:** Secure email and password login for all user roles.
*   **Password Reset:** Users can request a password reset link via email.
*   **Role-Based Access Control:** The system enforces strict role-based access. Users are redirected to the appropriate dashboard upon login. Unauthorized access attempts redirect users to the login page.
*   **Session Persistence:** User sessions are maintained after login.

### 3.2. Referrals & Invitations
*   **Lawyer-to-Client Invitation:** Lawyers can invite new or existing clients to the portal by generating a unique, secure registration link.
*   **Client-to-Client Referral:** Clients have a unique referral link to earn in-app "coins" when their friends register.

---

## 4. Super Admin Role: Features & Requirements

The Super Admin has global oversight of the entire platform.

### 4.1. Admin Dashboard
*   **High-Level Stats:** View key platform metrics: Total Applicants, Active Firms, Total Revenue, and Critical Action Items.
*   **Action Items:** A list of urgent tasks requiring administrative attention, such as pending lawyer account activations and overdue invoices.

### 4.2. User Management
*   **View & Manage Users:** Access separate lists for "Lawyers / Firms" and "Applicants / Clients".
*   **Lawyer Activation:** Approve, reject, or suspend lawyer accounts. View license and registration details for verification.
*   **Manage Subscriptions:** Modify the subscription plan (Starter, Pro, Enterprise) for any law firm.
*   **Client Management:** Block or manage client accounts.

### 4.3. Firm & Lead Management
*   **View Leads:** Manage a pipeline of potential law firms interested in joining the platform.
*   **Convert Leads:** Convert a qualified lead into a new law firm account, triggering the onboarding and activation process.

### 4.4. Platform Analytics
*   **Visual Reports:** View charts and graphs for:
    *   User Growth (Lawyers vs. Clients) over time.
    *   Quarterly Revenue.
    *   Breakdown of application statuses across the platform.
    *   Client geographic distribution.

### 4.5. Financial Oversight
*   **Firm Subscriptions:** View and manage the subscription status for all legal firms.
*   **Client Invoices:** View a log of all one-time invoices generated by lawyers for their clients.
*   **Transaction History:** A complete log of all payments processed.

### 4.6. Platform Settings
*   **General:** Manage platform branding (name, logo) and global feature flags.
*   **Billing & Subscriptions:** Configure pricing, features, and limits for each subscription tier.
*   **Integrations:** Manage global API keys for services like Google Cloud and Stripe.

### 4.7. Platform-wide Management
*   **Tasks:** View and manage internal tasks assigned to platform staff.
*   **Support Tickets:** View and manage support tickets submitted by all users.
*   **System Notifications:** Compose and send broadcast notifications to all users, lawyers only, or clients only.

## 5. Lawyer / Legal Professional Role: Features & Requirements

This role is for professionals managing their immigration practice.

### 5.1. Lawyer Dashboard
*   **Key Metrics:** At-a-glance view of Total Clients, Pending Applications, Upcoming Appointments, and Revenue.
*   **AI Risk Alerts:** An AI-powered tool that scans active client files and flags potential issues (e.g., approaching deadlines, missing documents).
*   **Recent Activity:** Lists of recent applications and upcoming appointments for quick access.

### 5.2. Client & Lead Management
*   **Client List (CRM):** A searchable and filterable database of all clients.
*   **Client Profile:** A detailed 360-degree view of a client, including case summary, documents, tasks, activity log, and AI-powered success predictions.
*   **Lead Management:** Manage a pipeline of prospective clients. Log activities (calls, emails) and convert qualified leads into active clients.

### 5.3. Document Management
*   **Document Library:** Create, edit, and manage reusable document templates.
*   **Document Categories:** Organize templates into categories (e.g., Express Entry, Work Permit) for easy assignment.
*   **Client Document Management:** Request documents from clients, review uploaded files, approve or reject submissions, and add comments.

### 5.4. AI-Powered Tools
*   **Document Summarizer:** Generate concise summaries of long documents.
*   **Application Checker:** Paste application text to check for errors, omissions, and inconsistencies.
*   **AI-Assisted Messaging:** Generate professional, context-aware messages for clients.
*   **Client Career Tools:** Generate resumes and cover letters for clients based on their intake form data to assist with their job search.

### 5.5. Team Management
*   **View Team:** View a roster of all team members within the firm.
*   **Manage Roles:** Assign access levels (Admin, Member, Viewer) to team members.
*   **Performance Tracking:** View performance metrics for individual team members.

### 5.6. Finance & Appointments
*   **Billing & Invoicing:** Create, view, and manage invoices for clients.
*   **Appointments:** View and manage a calendar of all client appointments.

## 6. Client / Applicant Role: Features & Requirements

This role is for the end-user seeking immigration services.

### 6.1. Onboarding
*   **CRS Score Calculator:** New users are guided through a multi-step form to collect data on their age, education, work experience, and language skills.
*   **AI-Powered Assessment:** The collected data is used to calculate an estimated Comprehensive Ranking System (CRS) score, providing immediate feedback and value to the user.

### 6.2. Client Dashboard
*   **Case Overview:** A welcome banner showing current application status and the next step.
*   **AI-Powered Timeline:** A personalized, estimated timeline of key milestones in the user's immigration journey.
*   **Quick Actions:** Easy access to view documents or message their lawyer.

### 6.3. Finding & Connecting with Lawyers
*   **Lawyer Directory:** A searchable directory of verified legal professionals on the platform. Users can filter by specialty, location, language, and consultation fee.
*   **Lawyer Profiles:** Detailed profile pages for each lawyer, showcasing their experience, specialties, stats, and firm details.
*   **Connection Request:** Clients can initiate a connection by sending a request that includes a message and a proposed meeting time selected from an interactive calendar. Their profile information and AI assessment score are shared upon sending the request.

### 6.4. Case & Document Management
*   **My Documents:** View a list of all requested and uploaded documents, track their status (Requested, Uploaded, Approved, Rejected), and upload new files.
*   **Editable Intake Form:** Clients can access and update their initial intake form data at any time. This form serves as a living profile.

### 6.5. Communication & AI Tools
*   **Secure Messaging:** A dedicated interface for direct, secure messaging with their connected legal team.
*   **AI Assist (Coin-Based):**
    *   **Writing Assistant:** Use "coins" to improve text for emails or other communications.
    *   **Resume & Cover Letter Builder:** Use "coins" to generate career documents based on their intake form data.

---

## 7. Technical Stack & Architecture

*   **Frontend:** Next.js (App Router), React, TypeScript
*   **UI:** ShadCN UI, Tailwind CSS
*   **AI/Backend Logic:** Google AI via Genkit
*   **State Management:** React Context API (`GlobalDataContext`)
*   **Database & Auth (Simulated/Planned):** Firebase (Firestore, Auth, Storage)

## 8. Future Considerations (Out of Scope for Current Build)

*   **Full Firebase Integration:** Implement live Firestore queries, secure file uploads to Firebase Storage, and robust Firestore Security Rules.
*   **Real-time Notifications:** Transition from static data to real-time updates for notifications and messages.
*   **Email Automation:** Integrate a service (e.g., using Firebase Functions) to send actual emails for invitations, password resets, and notifications.
